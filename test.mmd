flowchart TD

    A[Start Tracking Loop 600 ms] --> B[Get Current Timestamp]

    B --> C[SGP4 Propagation\n(TLE → TEME Position & Velocity)]

    C --> D[TEME → ECI Transform]
    D --> E[ECI → ECEF Transform]
    E --> F[ECEF → ENU Transform\nCompute (e, n, u)]

    F --> G[Compute Azimuth/Elevation]
    
    G --> H{Filtering Needed?}
    
    H -->|Deadband Suppresses Small Changes| A

    H -->|Zenith Protection\n(elevation > threshold)| I[Freeze Azimuth\nTrack Elevation Only]

    I --> J[Format GS-232B Command]
    H -->|Normal Conditions| J

    J --> K{≥ 1s Since Last Command?}
    
    K -->|No| A
    K -->|Yes| L[Send GS-232B Command]

    L --> M[Read C2 Feedback\n(rotator position)]

    M --> A[Loop Back]
